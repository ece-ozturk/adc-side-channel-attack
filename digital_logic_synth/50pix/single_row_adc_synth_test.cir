Simulation of digital counter circuit synthesized with Yosys

** opencircuitdesign pdks install
.lib "/foss/pdk/sky130A/libs.tech/ngspice/sky130.lib.spice" tt
.include "/foss/pdk/sky130A/libs.ref/sky130_fd_sc_hd/spice/sky130_fd_sc_hd.spice"
.include counter_synth.model
.include register_array_synth1.model
.include register_array_synth2.model
.include register_array_synth3.model
.include register_array_synth4.model
.include register_array_synth5.model
.include register_array_synth6.model
.include register_array_synth7.model
.include register_array_synth8.model
.include register_array_synth9.model
.include register_array_synth10.model
.include edge_detector_synth1.model
.include edge_detector_synth2.model
.include edge_detector_synth3.model
.include edge_detector_synth4.model
.include edge_detector_synth5.model
.include edge_detector_synth6.model
.include edge_detector_synth7.model
.include edge_detector_synth8.model
.include edge_detector_synth9.model
.include edge_detector_synth10.model

* Instantiate counter module
XCOUNTER clk reset count.0 count.1 count.2 count.3 count.4 count.5 count.6 count.7 vss vss vdd vdd counter

* Instantiate edge detector module (detects rising edges of comparator signals)
XEDGE_DETECTOR1 clk reset comp.0 comp.1 comp.2 comp.3 comp.4 enable.0 enable.1 enable.2 enable.3 enable.4 vss vss vdd vdd edge_detector1
XEDGE_DETECTOR2 clk reset comp.5 comp.6 comp.7 comp.8 comp.9 enable.5 enable.6 enable.7 enable.8 enable.9 vss vss vdd vdd edge_detector2
XEDGE_DETECTOR3 clk reset comp.10 comp.11 comp.12 comp.13 comp.14 enable.10 enable.11 enable.12 enable.13 enable.14 vss vss vdd vdd edge_detector3
XEDGE_DETECTOR4 clk reset comp.15 comp.16 comp.17 comp.18 comp.19 enable.15 enable.16 enable.17 enable.18 enable.19 vss vss vdd vdd edge_detector4
XEDGE_DETECTOR5 clk reset comp.20 comp.21 comp.22 comp.23 comp.24 enable.20 enable.21 enable.22 enable.23 enable.24 vss vss vdd vdd edge_detector5
XEDGE_DETECTOR6 clk reset comp.25 comp.26 comp.27 comp.28 comp.29 enable.25 enable.26 enable.27 enable.28 enable.29 vss vss vdd vdd edge_detector6
XEDGE_DETECTOR7 clk reset comp.30 comp.31 comp.32 comp.33 comp.34 enable.30 enable.31 enable.32 enable.33 enable.34 vss vss vdd vdd edge_detector7
XEDGE_DETECTOR8 clk reset comp.35 comp.36 comp.37 comp.38 comp.39 enable.35 enable.36 enable.37 enable.38 enable.39 vss vss vdd vdd edge_detector8
XEDGE_DETECTOR9 clk reset comp.40 comp.41 comp.42 comp.43 comp.44 enable.40 enable.41 enable.42 enable.43 enable.44 vss vss vdd vdd edge_detector9
XEDGE_DETECTOR10 clk reset comp.45 comp.46 comp.47 comp.48 comp.49 enable.45 enable.46 enable.47 enable.48 enable.49 vss vss vdd vdd edge_detector10

* Instantiate registers module (stores values based on edge detector output)
XREGISTER_ARRAY1 clk reset enable.0 enable.1 enable.2 enable.3 enable.4 count.0 count.1 count.2 count.3 count.4 count.5 count.6 count.7 stored_values.0 stored_values.1 stored_values.2 stored_values.3 stored_values.4 stored_values.5 stored_values.6 stored_values.7 stored_values.8 stored_values.9 stored_values.10 stored_values.11 stored_values.12 stored_values.13 stored_values.14 stored_values.15 stored_values.16 stored_values.17 stored_values.18 stored_values.19 stored_values.20 stored_values.21 stored_values.22 stored_values.23 stored_values.24 stored_values.25 stored_values.26 stored_values.27 stored_values.28 stored_values.29 stored_values.30 stored_values.31 stored_values.32 stored_values.33 stored_values.34 stored_values.35 stored_values.36 stored_values.37 stored_values.38 stored_values.39 vss vss vdd vdd register_array1
XREGISTER_ARRAY2 clk reset enable.5 enable.6 enable.7 enable.8 enable.9 count.0 count.1 count.2 count.3 count.4 count.5 count.6 count.7 stored_values.40 stored_values.41 stored_values.42 stored_values.43 stored_values.44 stored_values.45 stored_values.46 stored_values.47 stored_values.48 stored_values.49 stored_values.50 stored_values.51 stored_values.52 stored_values.53 stored_values.54 stored_values.55 stored_values.56 stored_values.57 stored_values.58 stored_values.59 stored_values.60 stored_values.61 stored_values.62 stored_values.63 stored_values.64 stored_values.65 stored_values.66 stored_values.67 stored_values.68 stored_values.69 stored_values.70 stored_values.71 stored_values.72 stored_values.73 stored_values.74 stored_values.75 stored_values.76 stored_values.77 stored_values.78 stored_values.79 vss vss vdd vdd register_array2
XREGISTER_ARRAY3 clk reset enable.10 enable.11 enable.12 enable.13 enable.14 count.0 count.1 count.2 count.3 count.4 count.5 count.6 count.7 stored_values.80 stored_values.81 stored_values.82 stored_values.83 stored_values.84 stored_values.85 stored_values.86 stored_values.87 stored_values.88 stored_values.89 stored_values.90 stored_values.91 stored_values.92 stored_values.93 stored_values.94 stored_values.95 stored_values.96 stored_values.97 stored_values.98 stored_values.99 stored_values.100 stored_values.101 stored_values.102 stored_values.103 stored_values.104 stored_values.105 stored_values.106 stored_values.107 stored_values.108 stored_values.109 stored_values.110 stored_values.111 stored_values.112 stored_values.113 stored_values.114 stored_values.115 stored_values.116 stored_values.117 stored_values.118 stored_values.119 vss vss vdd vdd register_array3
XREGISTER_ARRAY4 clk reset enable.15 enable.16 enable.17 enable.18 enable.19 count.0 count.1 count.2 count.3 count.4 count.5 count.6 count.7 stored_values.120 stored_values.121 stored_values.122 stored_values.123 stored_values.124 stored_values.125 stored_values.126 stored_values.127 stored_values.128 stored_values.129 stored_values.130 stored_values.131 stored_values.132 stored_values.133 stored_values.134 stored_values.135 stored_values.136 stored_values.137 stored_values.138 stored_values.139 stored_values.140 stored_values.141 stored_values.142 stored_values.143 stored_values.144 stored_values.145 stored_values.146 stored_values.147 stored_values.148 stored_values.149 stored_values.150 stored_values.151 stored_values.152 stored_values.153 stored_values.154 stored_values.155 stored_values.156 stored_values.157 stored_values.158 stored_values.159 vss vss vdd vdd register_array4
XREGISTER_ARRAY5 clk reset enable.20 enable.21 enable.22 enable.23 enable.24 count.0 count.1 count.2 count.3 count.4 count.5 count.6 count.7 stored_values.160 stored_values.161 stored_values.162 stored_values.163 stored_values.164 stored_values.165 stored_values.166 stored_values.167 stored_values.168 stored_values.169 stored_values.170 stored_values.171 stored_values.172 stored_values.173 stored_values.174 stored_values.175 stored_values.176 stored_values.177 stored_values.178 stored_values.179 stored_values.180 stored_values.181 stored_values.182 stored_values.183 stored_values.184 stored_values.185 stored_values.186 stored_values.187 stored_values.188 stored_values.189 stored_values.190 stored_values.191 stored_values.192 stored_values.193 stored_values.194 stored_values.195 stored_values.196 stored_values.197 stored_values.198 stored_values.199 vss vss vdd vdd register_array5
XREGISTER_ARRAY6 clk reset enable.25 enable.26 enable.27 enable.28 enable.29 count.0 count.1 count.2 count.3 count.4 count.5 count.6 count.7 stored_values.200 stored_values.201 stored_values.202 stored_values.203 stored_values.204 stored_values.205 stored_values.206 stored_values.207 stored_values.208 stored_values.209 stored_values.210 stored_values.211 stored_values.212 stored_values.213 stored_values.214 stored_values.215 stored_values.216 stored_values.217 stored_values.218 stored_values.219 stored_values.220 stored_values.221 stored_values.222 stored_values.223 stored_values.224 stored_values.225 stored_values.226 stored_values.227 stored_values.228 stored_values.229 stored_values.230 stored_values.231 stored_values.232 stored_values.233 stored_values.234 stored_values.235 stored_values.236 stored_values.237 stored_values.238 stored_values.239 vss vss vdd vdd register_array6
XREGISTER_ARRAY7 clk reset enable.30 enable.31 enable.32 enable.33 enable.34 count.0 count.1 count.2 count.3 count.4 count.5 count.6 count.7 stored_values.240 stored_values.241 stored_values.242 stored_values.243 stored_values.244 stored_values.245 stored_values.246 stored_values.247 stored_values.248 stored_values.249 stored_values.250 stored_values.251 stored_values.252 stored_values.253 stored_values.254 stored_values.255 stored_values.256 stored_values.257 stored_values.258 stored_values.259 stored_values.260 stored_values.261 stored_values.262 stored_values.263 stored_values.264 stored_values.265 stored_values.266 stored_values.267 stored_values.268 stored_values.269 stored_values.270 stored_values.271 stored_values.272 stored_values.273 stored_values.274 stored_values.275 stored_values.276 stored_values.277 stored_values.278 stored_values.279 vss vss vdd vdd register_array7
XREGISTER_ARRAY8 clk reset enable.35 enable.36 enable.37 enable.38 enable.39 count.0 count.1 count.2 count.3 count.4 count.5 count.6 count.7 stored_values.280 stored_values.281 stored_values.282 stored_values.283 stored_values.284 stored_values.285 stored_values.286 stored_values.287 stored_values.288 stored_values.289 stored_values.290 stored_values.291 stored_values.292 stored_values.293 stored_values.294 stored_values.295 stored_values.296 stored_values.297 stored_values.298 stored_values.299 stored_values.300 stored_values.301 stored_values.302 stored_values.303 stored_values.304 stored_values.305 stored_values.306 stored_values.307 stored_values.308 stored_values.309 stored_values.310 stored_values.311 stored_values.312 stored_values.313 stored_values.314 stored_values.315 stored_values.316 stored_values.317 stored_values.318 stored_values.319 vss vss vdd vdd register_array8
XREGISTER_ARRAY9 clk reset enable.40 enable.41 enable.42 enable.43 enable.44 count.0 count.1 count.2 count.3 count.4 count.5 count.6 count.7 stored_values.320 stored_values.321 stored_values.322 stored_values.323 stored_values.324 stored_values.325 stored_values.326 stored_values.327 stored_values.328 stored_values.329 stored_values.330 stored_values.331 stored_values.332 stored_values.333 stored_values.334 stored_values.335 stored_values.336 stored_values.337 stored_values.338 stored_values.339 stored_values.340 stored_values.341 stored_values.342 stored_values.343 stored_values.344 stored_values.345 stored_values.346 stored_values.347 stored_values.348 stored_values.349 stored_values.350 stored_values.351 stored_values.352 stored_values.353 stored_values.354 stored_values.355 stored_values.356 stored_values.357 stored_values.358 stored_values.359 vss vss vdd vdd register_array9
XREGISTER_ARRAY10 clk reset enable.45 enable.46 enable.47 enable.48 enable.49 count.0 count.1 count.2 count.3 count.4 count.5 count.6 count.7 stored_values.360 stored_values.361 stored_values.362 stored_values.363 stored_values.364 stored_values.365 stored_values.366 stored_values.367 stored_values.368 stored_values.369 stored_values.370 stored_values.371 stored_values.372 stored_values.373 stored_values.374 stored_values.375 stored_values.376 stored_values.377 stored_values.378 stored_values.379 stored_values.380 stored_values.381 stored_values.382 stored_values.383 stored_values.384 stored_values.385 stored_values.386 stored_values.387 stored_values.388 stored_values.389 stored_values.390 stored_values.391 stored_values.392 stored_values.393 stored_values.394 stored_values.395 stored_values.396 stored_values.397 stored_values.398 stored_values.399 vss vss vdd vdd register_array10

* Voltage sources
.param vdd=1.8
Vvdd vdd 0 {vdd}

.param vss=0
Vvss vss 0 {vss}

** Clock and Reset signals (1MHz clock)
Vrst    reset   0   pulse   {vdd}   {vss}   3u      2n  2n  490u    500u
Vclk    clk     0   pulse   {vss}   {vdd}   200n    1n  1n  0.5u      1u

* Comparator signal (example: 5 comparators with random outputs)
* Here, we simulate random '1's and '0's for comparators, adjust as needed
Vcomp0 comp.0 0 pulse {vdd} {vss} 0 5n 5n 5u 259u
Vcomp1 comp.1 0 pulse {vdd} {vss} 0 5n 5n 10u 259u
Vcomp2 comp.2 0 pulse {vdd} {vss} 0 5n 5n 15u 259u
Vcomp3 comp.3 0 pulse {vdd} {vss} 0 5n 5n 20u 259u
Vcomp4 comp.4 0 pulse {vdd} {vss} 0 5n 5n 25u 259u
Vcomp5 comp.5 0 pulse {vdd} {vss} 0 5n 5n 30u 259u
Vcomp6 comp.6 0 pulse {vdd} {vss} 0 5n 5n 35u 259u
Vcomp7 comp.7 0 pulse {vdd} {vss} 0 5n 5n 40u 259u
Vcomp8 comp.8 0 pulse {vdd} {vss} 0 5n 5n 45u 259u
Vcomp9 comp.9 0 pulse {vdd} {vss} 0 5n 5n 50u 259u
Vcomp10 comp.10 0 pulse {vdd} {vss} 0 5n 5n 55u 259u
Vcomp11 comp.11 0 pulse {vdd} {vss} 0 5n 5n 60u 259u
Vcomp12 comp.12 0 pulse {vdd} {vss} 0 5n 5n 65u 259u
Vcomp13 comp.13 0 pulse {vdd} {vss} 0 5n 5n 70u 259u
Vcomp14 comp.14 0 pulse {vdd} {vss} 0 5n 5n 75u 259u
Vcomp15 comp.15 0 pulse {vdd} {vss} 0 5n 5n 80u 259u
Vcomp16 comp.16 0 pulse {vdd} {vss} 0 5n 5n 85u 259u
Vcomp17 comp.17 0 pulse {vdd} {vss} 0 5n 5n 90u 259u
Vcomp18 comp.18 0 pulse {vdd} {vss} 0 5n 5n 95u 259u
Vcomp19 comp.19 0 pulse {vdd} {vss} 0 5n 5n 100u 259u
Vcomp20 comp.20 0 pulse {vdd} {vss} 0 5n 5n 105u 259u
Vcomp21 comp.21 0 pulse {vdd} {vss} 0 5n 5n 110u 259u
Vcomp22 comp.22 0 pulse {vdd} {vss} 0 5n 5n 115u 259u
Vcomp23 comp.23 0 pulse {vdd} {vss} 0 5n 5n 120u 259u
Vcomp24 comp.24 0 pulse {vdd} {vss} 0 5n 5n 125u 259u
Vcomp25 comp.25 0 pulse {vdd} {vss} 0 5n 5n 130u 259u
Vcomp26 comp.26 0 pulse {vdd} {vss} 0 5n 5n 135u 259u
Vcomp27 comp.27 0 pulse {vdd} {vss} 0 5n 5n 140u 259u
Vcomp28 comp.28 0 pulse {vdd} {vss} 0 5n 5n 145u 259u
Vcomp29 comp.29 0 pulse {vdd} {vss} 0 5n 5n 150u 259u
Vcomp30 comp.30 0 pulse {vdd} {vss} 0 5n 5n 155u 259u
Vcomp31 comp.31 0 pulse {vdd} {vss} 0 5n 5n 160u 259u
Vcomp32 comp.32 0 pulse {vdd} {vss} 0 5n 5n 165u 259u
Vcomp33 comp.33 0 pulse {vdd} {vss} 0 5n 5n 170u 259u
Vcomp34 comp.34 0 pulse {vdd} {vss} 0 5n 5n 175u 259u
Vcomp35 comp.35 0 pulse {vdd} {vss} 0 5n 5n 180u 259u
Vcomp36 comp.36 0 pulse {vdd} {vss} 0 5n 5n 185u 259u
Vcomp37 comp.37 0 pulse {vdd} {vss} 0 5n 5n 190u 259u
Vcomp38 comp.38 0 pulse {vdd} {vss} 0 5n 5n 195u 259u
Vcomp39 comp.39 0 pulse {vdd} {vss} 0 5n 5n 200u 259u
Vcomp40 comp.40 0 pulse {vdd} {vss} 0 5n 5n 205u 259u
Vcomp41 comp.41 0 pulse {vdd} {vss} 0 5n 5n 210u 259u
Vcomp42 comp.42 0 pulse {vdd} {vss} 0 5n 5n 215u 259u
Vcomp43 comp.43 0 pulse {vdd} {vss} 0 5n 5n 220u 259u
Vcomp44 comp.44 0 pulse {vdd} {vss} 0 5n 5n 225u 259u
Vcomp45 comp.45 0 pulse {vdd} {vss} 0 5n 5n 230u 259u
Vcomp46 comp.46 0 pulse {vdd} {vss} 0 5n 5n 235u 259u
Vcomp47 comp.47 0 pulse {vdd} {vss} 0 5n 5n 240u 259u
Vcomp48 comp.48 0 pulse {vdd} {vss} 0 5n 5n 245u 259u
Vcomp49 comp.49 0 pulse {vdd} {vss} 0 5n 5n 250u 259u

** Simulation settings
*.control
.option KLU
.tran 10n 259u
.save i(Vvdd)

*v(clk) v(reset) v(comp.0) v(comp.1) v(comp.2) v(comp.3) v(comp.4) v(stored_values.0) v(stored_values.1) v(stored_values.2) v(stored_values.3) v(stored_values.4) v(stored_values.5) v(stored_values.6) v(stored_values.7) v(stored_values.8) v(stored_values.9) v(stored_values.10) v(stored_values.11) v(stored_values.12) v(stored_values.13) v(stored_values.14) v(stored_values.15) v(stored_values.16) v(stored_values.17) v(stored_values.18) v(stored_values.19) v(stored_values.20) v(stored_values.21) v(stored_values.22) v(stored_values.23) v(stored_values.24) v(stored_values.25) v(stored_values.26) v(stored_values.27) v(stored_values.28) v(stored_values.29) v(stored_values.30) v(stored_values.31) v(stored_values.32) v(stored_values.33) v(stored_values.34) v(stored_values.35) v(stored_values.36) v(stored_values.37) v(stored_values.38) v(stored_values.39) i(vdd)

*plot v(clk) 2+v(reset) 4+v(comp.0) 6+v(comp.1) 8+v(comp.2) 10+v(comp.3) 12+v(comp.4)
*plot v(count.0) 2+v(count.1) 4+v(count.2) 6+v(count.3) 8+v(count.4) 10+v(count.5) 12+v(count.6) 14+v(count.7)
*plot v(stored_values.0) 2+v(stored_values.1) 4+v(stored_values.2) 6+v(stored_values.3) 8+v(stored_values.4) 10+v(stored_values.5) 12+v(stored_values.6) 14+v(stored_values.7)
*plot -100*i(vvdd)
*plot v(stored_values.8) 2+v(stored_values.9) 4+v(stored_values.10) 6+v(stored_values.11) 8+v(stored_values.12) 10+v(stored_values.13) 12+v(stored_values.14) 14+v(stored_values.15)
*plot v(stored_values.16) 2+v(stored_values.17) 4+v(stored_values.18) 6+v(stored_values.19) 8+v(stored_values.20) 10+v(stored_values.21) 12+v(stored_values.22) 14+v(stored_values.23)
*plot v(stored_values.24) 2+v(stored_values.25) 4+v(stored_values.26) 6+v(stored_values.27) 8+v(stored_values.28) 10+v(stored_values.29) 12+v(stored_values.30) 14+v(stored_values.31)
*plot v(stored_values.32) 2+v(stored_values.33) 4+v(stored_values.34) 6+v(stored_values.35) 8+v(stored_values.36) 10+v(stored_values.37) 12+v(stored_values.38) 14+v(stored_values.39)
*plot v(stored_values.40) 2+v(stored_values.41) 4+v(stored_values.42) 6+v(stored_values.43) 8+v(stored_values.44) 10+v(stored_values.45) 12+v(stored_values.46) 14+v(stored_values.47)
*plot v(stored_values.48) 2+v(stored_values.49) 4+v(stored_values.50) 6+v(stored_values.51) 8+v(stored_values.52) 10+v(stored_values.53) 12+v(stored_values.54) 14+v(stored_values.55)
*plot v(stored_values.56) 2+v(stored_values.57) 4+v(stored_values.58) 6+v(stored_values.59) 8+v(stored_values.60) 10+v(stored_values.61) 12+v(stored_values.62) 14+v(stored_values.63)
*plot v(stored_values.64) 2+v(stored_values.65) 4+v(stored_values.66) 6+v(stored_values.67) 8+v(stored_values.68) 10+v(stored_values.69) 12+v(stored_values.70) 14+v(stored_values.71)
*plot v(stored_values.72) 2+v(stored_values.73) 4+v(stored_values.74) 6+v(stored_values.75) 8+v(stored_values.76) 10+v(stored_values.77) 12+v(stored_values.78) 14+v(stored_values.79)
*.endc

.END